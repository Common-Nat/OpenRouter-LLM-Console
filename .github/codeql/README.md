# CodeQL Configuration

This directory contains CodeQL security scanning configuration for the OpenRouter LLM Console.

## Files

- `codeql-config.yml` - Main CodeQL configuration file

## Excluded Paths

The following paths are excluded from CodeQL scanning as they contain generated or third-party code:

### Generated Coverage Reports
- `frontend/coverage/**` - Vitest/Istanbul HTML coverage reports
- `backend/htmlcov/**` - pytest-cov HTML coverage reports

**Note:** These directories should never be committed to git (see root `.gitignore`).

### Build Outputs
- `frontend/dist/**` - Production build output
- `frontend/build/**` - Alternative build directory

### Dependencies
- `frontend/node_modules/**` - npm packages
- `backend/.venv/**` - Python virtual environment
- `backend/venv/**` - Alternative venv name
- `backend/__pycache__/**` - Python bytecode cache

### Test Files
- `**/tests/**` - Test directories
- `**/test_*.py` - Python test files
- `**/*.test.js` - JavaScript test files
- `**/*.test.jsx` - React test files
- `**/*.spec.js` - JavaScript spec files
- `**/*.spec.jsx` - React spec files

## Query Filters

### XSS Through DOM (js/xss-through-dom)
Suppressed for coverage report HTML files which contain auto-generated JavaScript with known false positives (e.g., `sorter.js` table manipulation code).

**Rationale:** Coverage HTML is generated by trusted tools (Vitest/Istanbul) and never deployed to production. These files should not exist in the repository.

## Usage in GitHub Actions

Reference this config in your CodeQL workflow:

```yaml
- name: Initialize CodeQL
  uses: github/codeql-action/init@v3
  with:
    config-file: ./.github/codeql/codeql-config.yml
    languages: javascript, python
```

## Removing Generated Files from Git

If coverage reports were previously committed:

```bash
# Remove from git (keeps local files)
git rm -r --cached frontend/coverage backend/htmlcov

# Commit the removal
git commit -m "Remove generated coverage files from repository"
git push
```

The `.gitignore` file ensures these won't be committed again.

## Security Notes

- **Only generated files** should be excluded from scanning
- **Never** exclude source code directories
- **Review** any new exclusions carefully
- **Document** the reason for each exclusion

## References

- [CodeQL Configuration Reference](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/customizing-code-scanning)
- [CodeQL Query Help](https://codeql.github.com/codeql-query-help/)
